<ng-container *ngFor="let row of dataStateService.dataRows">
  <ng-container *ngFor="let ignored of getRowSpanCollection(row); let rowSpanIndex = index; let rowSpanCount = count">
      <tr class="ng-data-table-row"
          (init)="onRowInit(row)"
          [attr.title]="row.tooltip"
          [class.row-odd]="isOddRow(row)"
          [class.row-even]="isEvenRow(row)"
          [class.selected]="row.selected"
          [class.clickable]="config.selectOnRowClick"
          [class.disabled]="row.disabled"
          (dblclick)="rowDoubleClicked(row, $event)"
          (click)="rowClicked(row, $event)">
        <td class="ng-data-table-row-expand-button ng-ignore-propagation" [style.background-color]="row.colour"
            *ngIf="config.expandableRows && !rowSpanIndex"
            (click)="onRowExpand($event, row)" [attr.rowspan]="rowSpanCount">
          <span class="zmdi zmdi-caret-right-circle zmdi-hc-lg ng-ignore-propagation" *ngIf="!row.expanded"></span>
          <span class="zmdi zmdi-caret-down-circle zmdi-hc-lg ng-ignore-propagation" *ngIf="row.expanded"></span>
        </td>
        <td class="index-column" [style.background-color]="row.colour"
            *ngIf="config.showIndexColumn && !rowSpanIndex"
            [textContent]="getDisplayIndex(row)" [attr.rowspan]="rowSpanCount">
        </td>
        <td class="ng-data-table-select-column ng-ignore-propagation" [style.background-color]="row.colour"
            *ngIf="showRowSelectCheckbox && !rowSpanIndex" [attr.rowspan]="rowSpanCount">
          <input class="ng-data-table-checkbox-input ng-ignore-propagation" type="checkbox" [(ngModel)]="row.selected"
                 (change)="onRowSelectChange(row)"/>
        </td>
        <ng-container *ngFor="let column of columns">
          <ng-container *ngIf="column.visible">
            <td class="ng-data-table-data-column" *ngIf="!column.cellTemplate && !rowSpanIndex"
                (init)="onCellInit(column, row)" [ngClass]="column.styleClass" [attr.rowspan]="rowSpanCount"
                [style.background-color]="column.getCellColor(row) || row.colour"
                (click)="cellClicked(column, row, $event)">
              <span>{{ getFieldValue(row, column) }}</span>
            </td>
            <ng-container *ngIf="column.cellTemplate" [ngTemplateOutlet]="column.cellTemplate"
                          [ngTemplateOutletContext]="{ column: column, row: row, spanIndex: rowSpanIndex, rowSpan: rowSpanCount  }">
            </ng-container>
          </ng-container>
        </ng-container>
      </tr>
    </ng-container>
  <tr *ngIf="config.expandableRows" [hidden]="!row.expanded" class="ng-data-table-row-expansion">
    <td [attr.colspan]="totalColumnCount">
      <ng-container [ngTemplateOutlet]="expandTemplate" [ngTemplateOutletContext]="{ row: row }">
      </ng-container>
    </td>
  </tr>
</ng-container>
<ng-container *ngIf="hasSubstituteRows">
  <tr *ngFor="let ignored of dataStateService.substituteItems, let index = index"
      [class.row-odd]="isOddSubstituteRow(index)" [class.row-even]="isEvenSubstituteRow(index)">
    <td *ngIf="config.expandableRows">&nbsp;</td>
    <td *ngIf="config.showIndexColumn">&nbsp;</td>
    <td *ngIf="config.rowSelectable">&nbsp;</td>
    <ng-container *ngFor="let column of columns">
      <td *ngIf="column.visible">&nbsp;</td>
    </ng-container>
  </tr>
</ng-container>
