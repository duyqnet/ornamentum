<div class="ng-dropdown-menu-wrapper"
     [style.width]="config.menuWidth | px"
     [style.height]="config.menuHeight | px"
     [style.right]="props.dropdown.positionRight()"
     [style.bottom]="props.dropdown.positionBottom()">
  <ul class="ng-dropdown-menu" (click)="$event.stopPropagation()">
    <li *ngIf="config.filterable">
      <ul>
        <li class="ng-dropdown-search">
          <div class="ng-dropdown-input-group">
          <span class="ng-dropdown-input-group-addon" id="sizing-addon3">
            <i class="zmdi zmdi-search"></i>
          </span>
          <input type="text" class="ng-dropdown-input" focus
                 [attr.placeholder]="config.translations.filterPlaceholder"
                 (keyup)="props.dropdown.filterKeyUp()"
                 [(ngModel)]="dataStateService.filterText">
          <span class="ng-dropdown-input-group-btn" *ngIf="dataStateService.filterText">
            <button class="ng-dropdown-delete-button" type="button" (click)="props.dropdown.clearFilter()">
              <i class="zmdi zmdi-close-circle"></i>
            </button>
          </span>
          </div>
        </li>
        <li class="ng-dropdown-divider divider"></li>
      </ul>
    </li>

    <li *ngIf="config.showSelectAll && config.multiSelectable && !config.loadOnScroll">
      <ul>
        <li class="ng-dropdown-item check-control check-control-check"
            (click)="props.dropdown.toggleAllOptionSelectedState()">
          <input type="checkbox" class="ng-dropdown-checkbox-input" [checked]="props.dropdown.allOptionsSelected"/>
          <span>{{ config.translations.selectAllPlaceholder }}</span>
        </li>
        <li class="ng-dropdown-divider divider"></li>
      </ul>
    </li>

    <li>
      <ul class="ng-dropdown-item-container" [class.ng-milti-selectable]="config.multiSelectable"
          [style.height]="config.menuHeight - 135 | px"
          (scroll)="config.loadOnScroll ? props.dropdown.checkScrollPosition($event) : null" >
        <!-- TODO: Fix menu height calculation -->
        <ng-container *ngIf="config.groupByField">
          <ng-container *ngFor="let groupedItem of dataStateService.dropdownItemGroups">
            <li class="ng-dropdown-group-heading">{{ groupedItem.groupName }}</li>
            <ng-container *ngFor="let option of groupedItem.items">
              <li (click)="props.dropdown.toggleOptionSelectedState(option)" [class.disabled]="option.disabled"
                  [class.ng-item-selected]="option.selected">
                <a role="menuitem">
                  <input type="checkbox" class="ng-dropdown-checkbox-input" [checked]="option.selected"
                         [disabled]="option.disabled" *ngIf="config.showOptionSelectCheckbox"/>
                  <span>{{ props.dropdown.getDisplayText(option.item) }}</span>
                </a>
              </li>
            </ng-container>
          </ng-container>
        </ng-container>
        <ng-container *ngIf="!config.groupByField">
          <ng-container *ngFor="let option of dataStateService.dropdownItems">
            <li (click)="props.dropdown.toggleOptionSelectedState(option)" [class.disabled]="option.disabled"
                [class.ng-item-selected]="option.selected">
              <a role="menuitem">
                <input type="checkbox" class="ng-dropdown-checkbox-input" [checked]="option.selected"
                       [disabled]="option.disabled" *ngIf="config.showOptionSelectCheckbox"/>
                <span>{{ props.dropdown.getDisplayText(option.item) }}</span>
              </a>
            </li>
          </ng-container>
        </ng-container>
        <li *ngIf="!dataStateService.dataLoading && !dataStateService.totalOptionCount" class="ng-dropdown-empty">
          {{config.translations.noDataMessage}}
        </li>
        <li *ngIf="dataStateService.dataLoading" class="ng-dropdown-loading">
          Loading...
        </li>
      </ul>
    </li>
  </ul>
</div>
